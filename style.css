* { 
    margin: 0; 
    padding: 0; 
    box-sizing: border-box; 
}

body {
    font-family: 'Hiragino Maru Gothic Pro', 'Rounded Mplus 1c', sans-serif;
    background: linear-gradient(to bottom, #a8e6cf, #dcedc1);
    text-align: center;
    min-height: 100vh;
    padding: 20px;
    font-size: 5.5vw;
    overflow-x: hidden;
    touch-action: manipulation; /* スムーズなタッチ操作 */
}

h1 { 
    font-size: 9vw; 
    color: #e74c3c; 
    margin-bottom: 40px; 
    text-shadow: 3px 3px 6px rgba(0,0,0,0.2);
}

h2 { 
    font-size: 7vw; 
    color: #27ae60; 
    margin: 20px 0; 
}

button { 
    border: none; 
    border-radius: 20px; 
    padding: 18px; 
    font-size: 6.5vw; 
    cursor: pointer; 
    box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    transition: all 0.2s;
}

button:active { 
    transform: translateY(4px); 
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.mode-btn { 
    width: 80%; 
    max-width: 360px; 
    margin: 20px auto; 
    padding: 25px; 
    font-size: 7.5vw; 
}

.slide { 
    background: #ffb347; 
    color: white;
    box-shadow: 0 8px #e67e22; 
}

.challenge { 
    background: #6c5ce7; 
    color: white; 
    box-shadow: 0 8px #5f3dc4; 
}

/* 難易度選択（中央揃え） */
.select-wrapper {
    width: 80%;
    max-width: 360px;
    margin: 30px auto;
    text-align: center;
}

#difficulty {
    background: #6c5ce7;
    color: white;
    font-size: 7vw;
    padding: 20px;
    width: 100%;
    border-radius: 20px;
    text-align: center;
    text-align-last: center;        /* iOS Safari対応 */
    -moz-text-align-last: center;   /* Firefox対応 */
    appearance: none;
    -webkit-appearance: none;
}

.hidden { 
    display: none !important; 
}

/* スライドモード */
#slide-image {
    width: 85vw; 
    height: 60vh; 
    max-width: 500px; 
    max-height: 500px;
    margin: 30px auto;
    background-size: contain; 
    background-repeat: no-repeat; 
    background-position: center;
    border: 10px solid #ffd93d; 
    border-radius: 40px; 
    box-shadow: 0 15px 30px rgba(0,0,0,0.3);
}

#progress { 
    display: flex; 
    justify-content: center; 
    gap: 12px; 
    margin: 30px 0; 
}

.progress-icon { 
    width: 45px; 
    height: 45px; 
    border-radius: 50%; 
    background-size: cover; 
    opacity: 0.5; 
    border: 4px solid #fff; 
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.current { 
    opacity: 1; 
    transform: scale(1.3); 
    border: 6px solid #e74c3c; 
}

/* チャレンジモード */
.scroll-container {
    overflow-x: auto; 
    white-space: nowrap; 
    -webkit-overflow-scrolling: touch;
    padding: 20px 0;
    scrollbar-width: none;
    scroll-behavior: smooth;
}

.scroll-container::-webkit-scrollbar { 
    display: none; 
}

#challenge-slots { 
    display: inline-flex; 
    gap: 20px; 
    padding: 0 20px; 
}

#options-wrapper {
    background: rgba(255,255,255,0.7);
    border-radius: 30px;
    padding: 20px;
    margin: 20px;
    max-height: 40vh;
    overflow: hidden;
}

#challenge-options {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
}

.slot, .option {
    width: 90px; 
    height: 90px; 
    flex-shrink: 0;
    background-size: contain; 
    background-repeat: no-repeat; 
    background-position: center;
    border-radius: 20px; 
    box-shadow: 0 6px 12px rgba(0,0,0,0.2);
}

.slot { 
    border: 6px dashed #ddd; 
}

.slot.filled { 
    border: 6px solid #2ecc71; 
}

.slot.fixed {
    cursor: default !important;
    pointer-events: none;
}

.option { 
    border: 6px solid #3498db; 
    cursor: grab; 
}

.option:active { 
    cursor: grabbing; 
    transform: scale(0.9); 
}

.big-btn { 
    background: #e17055; 
    color: white; 
    font-size: 8vw; 
    padding: 25px; 
    width: 80%; 
    margin: 30px auto; 
    box-shadow: 0 10px #c0392b; 
}

.big-btn.retry {
    background: #f39c12 !important;
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

.small-btn { 
    background: #b2bec3; 
    color: white; 
    padding: 15px 30px; 
    margin: 20px; 
    border-radius: 15px; 
}

/* 正解・不正解オーバーレイ */
#result-overlay {
    position: fixed; 
    top: 0; 
    left: 0; 
    width: 100%; 
    height: 100%;
    background: rgba(0,0,0,0.8); 
    z-index: 999;
    display: flex; 
    align-items: center; 
    justify-content: center; 
    font-size: 50vw; 
    font-weight: bold;
}

.correct { 
    color: #e74c3c; 
    animation: correctAnim 1.5s ease-out; 
}

.wrong { 
    color: #3498db; 
    animation: wrongAnim 0.8s ease-out; 
}

.wrong-flash { 
    border: 8px solid #e74c3c !important; 
    animation: flash 0.4s 4; 
}

@keyframes correctAnim {
    0% { transform: scale(0) rotate(-360deg); }
    70% { transform: scale(1.2); }
    100% { transform: scale(1); }
}

@keyframes wrongAnim {
    0%,100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

@keyframes flash {
    0%,100% { box-shadow: 0 0 20px #e74c3c; }
    50% { box-shadow: 0 0 40px #ff0000; }
}

/* 花火キャンバス */
#fireworks {
    position: fixed;
    top: 0; 
    left: 0;
    width: 100%; 
    height: 100%;
    pointer-events: none;
    z-index: 998;
    opacity: 0;
    transition: opacity 0.5s;
}

#fireworks.active {
    opacity: 1 !important;
}

/* 横画面対応 */
@media (orientation: landscape) {
    body { font-size: 4vw; }
    #slide-image { height: 65vh; }
    h1 { font-size: 7vw; }
    h2 { font-size: 6vw; }
}
